{
  "version": "0",
  "id": "d0731104-32d1-cab5-062e-848cc3bd884e",
  "detail-type": "Security Hub Findings - Imported",
  "source": "aws.securityhub",
  "account": "363265257036",
  "time": "2021-08-07T21:54:44Z",
  "region": "us-east-1",
  "resources": [
    "arn:aws:securityhub:us-east-1::product/aws/securityhub/arn:aws:securityhub:us-east-1:363265257036:subscription/aws-foundational-security-best-practices/v/1.0.0/APIGateway.4/finding/227ca420-48fa-4df8-ad47-f747521d169a"
  ],
  "detail": {
    "findings": [
      {
        "ProductArn": "arn:aws:securityhub:us-east-1::product/aws/securityhub",
        "Types": [
          "Software and Configuration Checks/Industry and Regulatory Standards/AWS-Foundational-Security-Best-Practices"
        ],
        "Description": "This control checks to see if an API Gateway stage is using an AWS WAF Web ACL. This control fails if an AWS WAF Web ACL is not attached to a REST API Gateway stage.",
        "Compliance": {
          "Status": "FAILED"
        },
        "ProductName": "Security Hub",
        "FirstObservedAt": "2021-08-07T00:10:26.826Z",
        "CreatedAt": "2021-08-07T00:10:26.826Z",
        "LastObservedAt": "2021-08-07T21:54:40.927Z",
        "CompanyName": "AWS",
        "FindingProviderFields": {
          "Types": [
            "Software and Configuration Checks/Industry and Regulatory Standards/AWS-Foundational-Security-Best-Practices"
          ],
          "Severity": {
            "Normalized": 40,
            "Label": "MEDIUM",
            "Product": 40,
            "Original": "MEDIUM"
          }
        },
        "ProductFields": {
          "StandardsArn": "arn:aws:securityhub:::standards/aws-foundational-security-best-practices/v/1.0.0",
          "StandardsSubscriptionArn": "arn:aws:securityhub:us-east-1:363265257036:subscription/aws-foundational-security-best-practices/v/1.0.0",
          "ControlId": "APIGateway.4",
          "RecommendationUrl": "https://docs.aws.amazon.com/console/securityhub/APIGateway.4/remediation",
          "RelatedAWSResources:0/name": "securityhub-api-gw-associated-with-waf-a3d255be",
          "RelatedAWSResources:0/type": "AWS::Config::ConfigRule",
          "StandardsControlArn": "arn:aws:securityhub:us-east-1:363265257036:control/aws-foundational-security-best-practices/v/1.0.0/APIGateway.4",
          "aws/securityhub/ProductName": "Security Hub",
          "aws/securityhub/CompanyName": "AWS",
          "Resources:0/Id": "arn:aws:apigateway:us-east-1::/restapis/6u20vtvjpk/stages/v1",
          "aws/securityhub/FindingId": "arn:aws:securityhub:us-east-1::product/aws/securityhub/arn:aws:securityhub:us-east-1:363265257036:subscription/aws-foundational-security-best-practices/v/1.0.0/APIGateway.4/finding/227ca420-48fa-4df8-ad47-f747521d169a"
        },
        "Remediation": {
          "Recommendation": {
            "Text": "For directions on how to fix this issue, please consult the AWS Security Hub Foundational Security Best Practices documentation.",
            "Url": "https://docs.aws.amazon.com/console/securityhub/APIGateway.4/remediation"
          }
        },
        "SchemaVersion": "2018-10-08",
        "GeneratorId": "aws-foundational-security-best-practices/v/1.0.0/APIGateway.4",
        "RecordState": "ACTIVE",
        "Title": "APIGateway.4 API Gateway should be associated with a WAF Web ACL",
        "Workflow": {
          "Status": "NEW"
        },
        "Severity": {
          "Normalized": 40,
          "Label": "MEDIUM",
          "Product": 40,
          "Original": "MEDIUM"
        },
        "UpdatedAt": "2021-08-07T21:54:39.106Z",
        "WorkflowState": "NEW",
        "AwsAccountId": "363265257036",
        "Region": "us-east-1",
        "Id": "arn:aws:securityhub:us-east-1:363265257036:subscription/aws-foundational-security-best-practices/v/1.0.0/APIGateway.4/finding/227ca420-48fa-4df8-ad47-f747521d169a",
        "Resources": [
          {
            "Partition": "aws",
            "Type": "AwsApiGatewayStage",
            "Details": {
              "AwsApiGatewayStage": {
                "LastUpdatedDate": "2021-07-31T00:25:00.000Z",
                "DeploymentId": "pcp2gy",
                "Description": "Lambda API Stage v1",
                "CacheClusterStatus": "NOT_AVAILABLE",
                "StageName": "v1",
                "TracingEnabled": false,
                "CreatedDate": "2021-07-31T00:24:59.000Z",
                "CacheClusterEnabled": false
              }
            },
            "Region": "us-east-1",
            "Id": "arn:aws:apigateway:us-east-1::/restapis/6u20vtvjpk/stages/v1"
          }
        ]
      }
    ]
  }
}
